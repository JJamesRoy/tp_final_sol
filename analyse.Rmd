```{r}
library(tidyverse)
library(fastDummies)
library(glmnet)
library(stargazer)
```


```{r, warning=FALSE}
dat = read.csv("data.csv")

dat[1:147] = sapply(dat[1:147], as.numeric)
# Convertir en numeric à la place de character

dat_full = dat %>% mutate_at(vars(-c(11:13)), ~round(ifelse(is.na(.), mean(., na.rm = TRUE), .), 0))
# Imputer les données manquantes. Les colonnes exclues le sont car elles sont largement composé de NA et ça serait une mauvaise idée de les imputer

#dat_full[,-c(1,2,3,10,11,12,13)] = sapply(dat_full[,-c(1,2,3,10,11,12,13)], as.factor)

#dat_full[sapply(dat_full, is.character)] <- lapply(dat_full[sapply(dat_full, is.character)], as.factor)
# Changer la classe des variables catégorielles en facteur (ça bug donc en 2 fonctions)
```

```{r}
dat_full_clean = dat_full %>% select(c(age, niveau, sexe, statmar, travp, scolp, travm, scolm, negp1, negp8, negp9, negm1, negm8, negm9, dets1, mus2, mushr, alien1, alien2, sui1, drog1, drog2, drog3, drog4))
# Sélectionner les variables théoriquement intéressante
```

```{r}
corr_matrix <- cor(dat_full_clean)

# Sélectionner les paires de variables avec une corrélation supérieure à 0,9
high_corr_pairs <- which(corr_matrix > 0.9 & corr_matrix < 1, arr.ind = TRUE)

# Extraire les noms de variables correspondant aux paires de variables sélectionnées
high_corr_varnames <- unique(colnames(dat_full_clean)[high_corr_pairs[,2]])

# Afficher le vecteur de noms de variables avec une corrélation supérieure à 0,9
high_corr_varnames
```


```{r}
dat_lm = dat_full_clean %>% 
  mutate(sexe = ifelse(sexe == 2,1, 0), # 1 si gars, 0 sinon
         sui1 = ifelse(sui1 == 1, 1, 0), # 1 si envie de suicide, 0 sinon
         statmar = ifelse(statmar == 3, 0,1), #0 si parent divorcé
         travp = ifelse(travp == 1, 1, 0), # 1 si pere travail temps plein, 0 sinon
         scolp = ifelse(scolp == 4 | scolp == 5 | scolp == 6, 1, 0), # 1 si pere plus que sec 5, 0 sinon
         travm = ifelse(travm == 1, 1, 0), # 1 si mere travail temps plein, 0 sinon
         scolm = ifelse(scolm == 4 | scolm == 5 | scolm == 6, 1, 0), # 1 si mere plus que sec 5, 0 sinon
         negp1 = ifelse(negp1 >= 2, 1, 0), # 1 si pere interessé, 0 sinon
         negp8 = ifelse(negp8 >= 2, 1, 0), # 1 si pere aidé, 0 sinon
         negp9 = ifelse(negp9 >= 2, 1, 0), # 1 si pere prend le temps de discuté, 0 sinon
         negm1 = ifelse(negm1 >= 2, 1, 0), # 1 si mere interessé, 0 sinon,
         negm8 = ifelse(negm8 >= 2, 1, 0), # 1 si mere aidé, 0 sinon,
         negm9 = ifelse(negm9 >= 2, 1, 0), # 1 si mere prend le temps de discuté, 0 sinon, 
         dets1 = ifelse(dets1 >= 2, 1, 0), # 1 si senti despéré, 0 sinon
         metal = ifelse(mus2 >= 4, 1, 0), # 1 si aime le metal, 0 sinon
         alien1 = ifelse(alien1 >=4, 1, 0), # 1 si pense que pas de but à être en vie, 0 sinon
         alien2 = ifelse(alien2 >=4, 1, 0), # 1 si pense que bon à rien, 0 sinon
         drog = ifelse(drog1 >= 3 | drog2 >= 2 | drog3 >= 2 | drog4 >= 2, 1, 0)) # 1 si consomme de la drogue (pour alcool, +1 car normal de boire une fois de l'alcool), 0 sinon

dat_lm = dat_lm %>% select(-c('mus2', "drog1", "drog2", "drog3", "drog4"))
```

```{r}

```

